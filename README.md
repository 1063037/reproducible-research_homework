# Reproducible research: version control and R

## Answers
### Q1, 2, 3

https://github.com/1063037/logistic_growth

### Q4
a.

The script creates a function called "random_walk", which creates a dataframe with x and y coordinates, and time steps. The first step begins at 0,0 when t=1. For each subsequent step, a random angle is generated, which is used to determine the coordinates of the next step by moving from the previous step a distance of 0.25 units at this angle (and with sin/cos of the angle being used with 0.25 as a hypotenuse to calculate the value of the new coordinates). The object data1 is created using this function to simulate a random walk of 500 steps, as is data2. Data1 and data2 are both plotted using ggplot, with x and y coordinates on their respective axes and with the coordinates of each step joined together in order. The lines connecting each point are coloured with a gradient of dark to light blue which represents how far in time each step is. The two plots are then displayed next to each other, which makes it easy to compare the two different random paths. Running the code again will result in different random paths.

b.

A random seed is an identifier (usually a number, or some other string of characters) for a specific sequence of random numbers generated by a random number generator (this works because computers can only actually generate "pseudo-randomness"). This means that when inputting a seed, the generator will output the same random numbers every time the same seed is used. This is useful for making code reproducible, as use of random seeds in any randomised elements will ensure the same randomness is produced by everyone using that code (so long as they do not change the seed).

c.

See "random_walk.R" in "question-4-code" folder

d.

Could not fit the entire edit in one screenshot so it is in two images:

![image](https://github.com/1063037/reproducible-research_homework/assets/150165336/69b0f180-f464-4c98-af1e-59c9f05d5bc7)

![image](https://github.com/1063037/reproducible-research_homework/assets/150165336/6435a092-9139-4eae-9283-53dff347095b)


### Q5
a.

There are 33 rows and 13 columns in the table.

b.

A log transformation makes the data linear when at low values of genome length (L). See R-script "Q5_script.R".

c.

Model gives intercept of 7.0748, and slope of 1.5152. p-value of the intercept was 2.28e-10, and the p-value of the slope was 6.44e-10. These are both statistically significant.

As V = (scaling factor) * L^(exponent),

log(V) = log((scaling factor) + log(L^(exponent)),

log(V) = log(scaling factor) + exponent*log(L)

Therefore, the intercept of the linear model = log(scaling factor)

So scaling factor = exp(intercept) = exp(7.0748) = 1181.807

Slope of the linear model = exponent = 1.5152

My values round to the same values as those found by the authors for dsDNA viruses (1.52 and 1182).
My values are both different to those the authors found for all viruses overall, however the value for the exponent is within the 95% confidence interval of the author's value, and the value of the scaling factor is very close to the boundary of the confidence interval.

d.

Code is also found in r-script for Q5.

ggplot(data = log_transform, aes(x = L_log, y = V_log))+
  geom_point(size = 2)+
  geom_smooth(method = "lm", colour = "#3366ff", linewidth = 0.7, se = TRUE)+
  theme_bw()+
  xlab("log [Genome length (kb)]")+
  ylab("log [Virion volume (nm3)]")

Copy of my figure:

![image](https://github.com/1063037/reproducible-research_homework/assets/150165336/30a748f3-15b4-437f-97f2-d0d3f72bb08d)

e.
A 300 kb dsDNA virus:
V = 1181.807*300^1.5152
V = 6697005.925 nm^3



## Instructions

The homework for this Computer skills practical is divided into 5 questions for a total of 100 points (plus an optional bonus question worth 10 extra points). First, fork this repo and make sure your fork is made **Public** for marking. Answers should be added to the # INSERT ANSWERS HERE # section above in the **README.md** file of your forked repository.

Questions 1, 2 and 3 should be answered in the **README.md** file of the `logistic_growth` repo that you forked during the practical. To answer those questions here, simply include a link to your logistic_growth repo.

**Submission**: Please submit a single **PDF** file with your candidate number (and no other identifying information), and a link to your fork of the `reproducible-research_homework` repo with the completed answers. All answers should be on the `main` branch.

## Assignment questions 

1) (**10 points**) Annotate the **README.md** file in your `logistic_growth` repo with more detailed information about the analysis. Add a section on the results and include the estimates for $N_0$, $r$ and $K$ (mention which *.csv file you used).
   
2) (**10 points**) Use your estimates of $N_0$ and $r$ to calculate the population size at $t$ = 4980 min, assuming that the population grows exponentially. How does it compare to the population size predicted under logistic growth? 

3) (**20 points**) Add an R script to your repository that makes a graph comparing the exponential and logistic growth curves (using the same parameter estimates you found). Upload this graph to your repo and include it in the **README.md** file so it can be viewed in the repo homepage.
   
4) (**30 points**) Sometimes we are interested in modelling a process that involves randomness. A good example is Brownian motion. We will explore how to simulate a random process in a way that it is reproducible:

   - A script for simulating a random_walk is provided in the `question-4-code` folder of this repo. Execute the code to produce the paths of two random walks. What do you observe? (10 points)
   - Investigate the term **random seeds**. What is a random seed and how does it work? (5 points)
   - Edit the script to make a reproducible simulation of Brownian motion. Commit the file and push it to your forked `reproducible-research_homework` repo. (10 points)
   - Go to your commit history and click on the latest commit. Show the edit you made to the code in the comparison view (add this image to the **README.md** of the fork). (5 points)

5) (**30 points**) In 2014, Cui, Schlub and Holmes published an article in the *Journal of Virology* (doi: https://doi.org/10.1128/jvi.00362-14) showing that the size of viral particles, more specifically their volume, could be predicted from their genome size (length). They found that this relationship can be modelled using an allometric equation of the form **$`V = \beta L^{\alpha}`$**, where $`V`$ is the virion volume in nm<sup>3</sup> and $`L`$ is the genome length in nucleotides.

   - Import the data for double-stranded DNA (dsDNA) viruses taken from the Supplementary Materials of the original paper into Posit Cloud (the csv file is in the `question-5-data` folder). How many rows and columns does the table have? (3 points)
   - What transformation can you use to fit a linear model to the data? Apply the transformation. (3 points)
   - Find the exponent ($\alpha$) and scaling factor ($\beta$) of the allometric law for dsDNA viruses and write the p-values from the model you obtained, are they statistically significant? Compare the values you found to those shown in **Table 2** of the paper, did you find the same values? (10 points)
   - Write the code to reproduce the figure shown below. (10 points)

  <p align="center">
     <img src="https://github.com/josegabrielnb/reproducible-research_homework/blob/main/question-5-data/allometric_scaling.png" width="600" height="500">
  </p>

  - What is the estimated volume of a 300 kb dsDNA virus? (4 points)

**Bonus** (**10 points**) Explain the difference between reproducibility and replicability in scientific research. How can git and GitHub be used to enhance the reproducibility and replicability of your work? what limitations do they have? (e.g. check the platform [protocols.io](https://www.protocols.io/)).
